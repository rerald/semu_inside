<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œí—˜ ì‘ì‹œ - ì„¸ë¬´ì¸ì‚¬ì´ë“œ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/common.css">
    <style>
        .exam-container {
            display: flex;
            flex-direction: column;
            min-height: 600px;
        }

        .exam-header {
            background: var(--primary-color);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .exam-info h2 {
            margin-bottom: 5px;
            font-size: 1.5rem;
        }

        .exam-meta {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .timer-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .timer {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 120px;
        }

        .timer-label {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .timer-value {
            font-size: 1.5rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }

        .timer.warning {
            background: rgba(255, 193, 7, 0.3);
            animation: pulse 1s infinite;
        }

        .timer.danger {
            background: rgba(220, 53, 69, 0.3);
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .exam-progress {
            background: white;
            padding: 15px 30px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin: 0 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-color);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .question-nav {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .question-btn {
            width: 35px;
            height: 35px;
            border: 2px solid #dee2e6;
            background: white;
            color: #6c757d;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
            font-weight: 600;
        }

        .question-btn.current {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .question-btn.answered {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .question-btn.flagged {
            background: #ffc107;
            color: #212529;
            border-color: #ffc107;
        }

        .main-content {
            flex: 1;
            display: flex;
            padding: 30px;
            gap: 30px;
            background: #f8f9fa;
        }

        .question-section {
            flex: 2;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .question-header {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f8f9fa;
        }

        .question-number {
            color: var(--primary-color);
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.1rem;
            line-height: 1.7;
            color: var(--dark-gray);
            margin-bottom: 20px;
        }

        .question-options {
            margin: 25px 0;
        }

        .option {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: var(--primary-color);
            background: #f8f9ff;
        }

        .option.selected {
            border-color: var(--primary-color);
            background: #e6f3ff;
        }

        .option-radio {
            width: 20px;
            height: 20px;
            border: 2px solid #dee2e6;
            border-radius: 50%;
            position: relative;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .option.selected .option-radio {
            border-color: var(--primary-color);
        }

        .option.selected .option-radio::after {
            content: '';
            width: 10px;
            height: 10px;
            background: var(--primary-color);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .option-text {
            flex: 1;
            line-height: 1.6;
        }

        .question-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f8f9fa;
        }

        .sidebar {
            flex: 1;
            max-width: 300px;
        }

        .sidebar-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .sidebar-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--dark-gray);
        }

        .exam-info-item {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        .flag-btn {
            background: transparent;
            border: 2px solid #ffc107;
            color: #ffc107;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .flag-btn.flagged {
            background: #ffc107;
            color: #212529;
        }

        .submit-section {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .submit-warning {
            font-size: 0.9rem;
            color: #856404;
            margin-bottom: 15px;
        }

        @media (max-width: 968px) {
            .main-content {
                flex-direction: column;
                padding: 20px;
            }
            
            .sidebar {
                max-width: none;
            }
            
            .exam-progress {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .progress-bar {
                margin: 0;
            }
            
            .question-nav {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="container">
            <div class="exam-container">
                <!-- ì‹œí—˜ í—¤ë” -->
                <div class="exam-header">
                    <div class="exam-info">
                        <h2 id="examTitle">ì‹œí—˜ ì œëª©</h2>
                        <div class="exam-meta">
                            <span id="examMeta">ë¬¸í•­ ìˆ˜ â€¢ ì œí•œ ì‹œê°„</span>
                        </div>
                    </div>
                    <div class="timer-section">
                        <div class="timer" id="timer">
                            <div class="timer-label">ë‚¨ì€ ì‹œê°„</div>
                            <div class="timer-value" id="timerValue">60:00</div>
                        </div>
                        <button class="btn btn-outline btn-small" onclick="confirmExit()">
                            <i class="fas fa-times"></i> ë‚˜ê°€ê¸°
                        </button>
                    </div>
                </div>

                <!-- ì§„í–‰ë¥  ë° ë¬¸ì œ ë„¤ë¹„ê²Œì´ì…˜ -->
                <div class="exam-progress">
                    <div style="font-size: 0.9rem; color: var(--medium-gray);">
                        ì§„í–‰ë¥ : <span id="progressText">1/20</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="question-nav" id="questionNav">
                        <!-- ë¬¸ì œ ë²ˆí˜¸ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <!-- ë©”ì¸ ì½˜í…ì¸  -->
                <div class="main-content">
                    <!-- ë¬¸ì œ ì„¹ì…˜ -->
                    <div class="question-section">
                        <div class="question-header">
                            <div class="question-number" id="questionNumber">ë¬¸ì œ 1</div>
                            <div class="question-text" id="questionText">
                                ë¬¸ì œê°€ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤...
                            </div>
                        </div>

                        <div class="question-options" id="questionOptions">
                            <!-- ì„ íƒì§€ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>

                        <div class="question-actions">
                            <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()">
                                <i class="fas fa-chevron-left"></i> ì´ì „
                            </button>
                            <button class="flag-btn" id="flagBtn" onclick="toggleFlag()">
                                <i class="fas fa-flag"></i> í‘œì‹œ
                            </button>
                            <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">
                                ë‹¤ìŒ <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- ì‚¬ì´ë“œë°” -->
                    <div class="sidebar">
                        <!-- ì‹œí—˜ ì •ë³´ -->
                        <div class="sidebar-section">
                            <h4 class="sidebar-title">
                                <i class="fas fa-info-circle"></i> ì‹œí—˜ ì •ë³´
                            </h4>
                            <div class="exam-info-item">
                                <span>ì „ì²´ ë¬¸í•­</span>
                                <span id="totalQuestions">20</span>
                            </div>
                            <div class="exam-info-item">
                                <span>ë‹µë³€ ì™„ë£Œ</span>
                                <span id="answeredCount">0</span>
                            </div>
                            <div class="exam-info-item">
                                <span>í‘œì‹œí•œ ë¬¸í•­</span>
                                <span id="flaggedCount">0</span>
                            </div>
                            <div class="exam-info-item">
                                <span>ë‚¨ì€ ë¬¸í•­</span>
                                <span id="remainingCount">20</span>
                            </div>
                        </div>

                        <!-- ì œì¶œ ì„¹ì…˜ -->
                        <div class="sidebar-section submit-section">
                            <h4 class="sidebar-title">
                                <i class="fas fa-paper-plane"></i> ì‹œí—˜ ì œì¶œ
                            </h4>
                            <div class="submit-warning">
                                ëª¨ë“  ë¬¸ì œë¥¼ ê²€í† í•œ í›„ ì œì¶œí•˜ì„¸ìš”.
                                ì œì¶œ í›„ì—ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                            </div>
                            <button class="btn btn-success btn-large" onclick="submitExam()">
                                <i class="fas fa-check"></i> ì‹œí—˜ ì œì¶œ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
    
    <!-- ê³µí†µ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="./assets/js/common.js"></script>
    
    <script>
        // ì‹œí—˜ ì‘ì‹œ í˜ì´ì§€ ì „ìš© ìŠ¤í¬ë¦½íŠ¸
        class ExamPage {
            constructor() {
                this.currentQuestion = 0;
                this.answers = {};
                this.flaggedQuestions = new Set();
                this.timeRemaining = 3600; // 60ë¶„
                this.timer = null;
                this.examData = null;
                
                this.init();
            }

            async init() {
                console.log('ğŸ“ ì‹œí—˜ í˜ì´ì§€ ì´ˆê¸°í™”');
                
                // ì¸ì¦ í™•ì¸
                if (!window.semuApp || !window.semuApp.requireAuth()) {
                    return;
                }

                // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì‹œí—˜ ID ê°€ì ¸ì˜¤ê¸°
                const urlParams = new URLSearchParams(window.location.search);
                const examId = urlParams.get('id');
                
                await this.loadExamData(examId);
                this.setupUI();
                this.startTimer();
            }

            async loadExamData(examId) {
                // Mock ì‹œí—˜ ë°ì´í„°
                const mockExams = {
                    'tax-2024-q1': {
                        title: '2024ë…„ 1ë¶„ê¸° ë¶€ê°€ê°€ì¹˜ì„¸ í‰ê°€',
                        duration: 3600, // 60ë¶„
                        questions: [
                            {
                                id: 1,
                                text: 'ë¶€ê°€ê°€ì¹˜ì„¸ ê³¼ì„¸í‘œì¤€ì€ ë‹¤ìŒ ì¤‘ ì–´ë–¤ ê²ƒì„ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆê¹Œ?',
                                options: [
                                    'ê³µê¸‰ê°€ì•¡',
                                    'ë§¤ì¶œì•¡',
                                    'ì†Œë“ê¸ˆì•¡',
                                    'ê³¼ì„¸ì†Œë“'
                                ],
                                correct: 0
                            },
                            {
                                id: 2,
                                text: 'ë¶€ê°€ê°€ì¹˜ì„¸ ë©´ì„¸ ì‚¬ì—…ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ê²ƒì€?',
                                options: [
                                    'ì˜ë£Œë³´ê±´ì„œë¹„ìŠ¤',
                                    'êµìœ¡ì„œë¹„ìŠ¤',
                                    'ê¸ˆìœµë³´í—˜ì„œë¹„ìŠ¤', 
                                    'ìŒì‹ì  ì„œë¹„ìŠ¤'
                                ],
                                correct: 3
                            },
                            {
                                id: 3,
                                text: 'ë¶€ê°€ê°€ì¹˜ì„¸ ì‹ ê³ ê¸°í•œì€ ë‹¤ìŒ ì¤‘ ì–¸ì œì…ë‹ˆê¹Œ?',
                                options: [
                                    'ê³¼ì„¸ê¸°ê°„ ì¢…ë£Œì¼ë¡œë¶€í„° 15ì¼ ì´ë‚´',
                                    'ê³¼ì„¸ê¸°ê°„ ì¢…ë£Œì¼ë¡œë¶€í„° 25ì¼ ì´ë‚´',
                                    'ê³¼ì„¸ê¸°ê°„ ì¢…ë£Œì¼ë¡œë¶€í„° 30ì¼ ì´ë‚´',
                                    'ê³¼ì„¸ê¸°ê°„ ì¢…ë£Œì¼ë¡œë¶€í„° 45ì¼ ì´ë‚´'
                                ],
                                correct: 1
                            }
                        ]
                    },
                    'income-basic': {
                        title: 'ì†Œë“ì„¸ë²• ê¸°ë³¸ í‰ê°€',
                        duration: 2700, // 45ë¶„
                        questions: [
                            {
                                id: 1,
                                text: 'ì†Œë“ì„¸ë²•ìƒ ê±°ì£¼ìì˜ ì •ì˜ëŠ”?',
                                options: [
                                    'êµ­ë‚´ì— ì£¼ì†Œë¥¼ ë‘ê±°ë‚˜ 183ì¼ ì´ìƒ ê±°ì†Œë¥¼ ë‘” ê°œì¸',
                                    'êµ­ë‚´ì— ì£¼ì†Œë¥¼ ë‘ê±°ë‚˜ 1ë…„ ì´ìƒ ê±°ì†Œë¥¼ ë‘” ê°œì¸',
                                    'êµ­ë‚´ì—ì„œ ì†Œë“ì´ ë°œìƒí•˜ëŠ” ê°œì¸',
                                    'êµ­ë‚´ì— ì£¼ì†Œë¥¼ ë‘” ê°œì¸'
                                ],
                                correct: 0
                            },
                            {
                                id: 2,
                                text: 'ê·¼ë¡œì†Œë“ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” ê²ƒì€?',
                                options: [
                                    'ìƒì—¬ê¸ˆ',
                                    'ìˆ˜ë‹¹',
                                    'ì´ìì†Œë“',
                                    'ì„±ê³¼ê¸‰'
                                ],
                                correct: 2
                            }
                        ]
                    }
                };

                this.examData = mockExams[examId] || mockExams['tax-2024-q1'];
                this.timeRemaining = this.examData.duration;
                
                console.log('âœ… ì‹œí—˜ ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', this.examData.title);
            }

            setupUI() {
                // ì‹œí—˜ ì œëª© ë° ë©”íƒ€ ì •ë³´
                document.getElementById('examTitle').textContent = this.examData.title;
                document.getElementById('examMeta').textContent = 
                    `${this.examData.questions.length}ë¬¸í•­ â€¢ ${Math.floor(this.examData.duration / 60)}ë¶„`;
                
                // ë¬¸ì œ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìƒì„±
                this.createQuestionNavigation();
                
                // ì²« ë²ˆì§¸ ë¬¸ì œ í‘œì‹œ
                this.showQuestion(0);
                
                // í†µê³„ ì—…ë°ì´íŠ¸
                this.updateStats();
            }

            createQuestionNavigation() {
                const nav = document.getElementById('questionNav');
                nav.innerHTML = '';
                
                this.examData.questions.forEach((_, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'question-btn';
                    btn.textContent = index + 1;
                    btn.onclick = () => this.showQuestion(index);
                    nav.appendChild(btn);
                });
            }

            showQuestion(index) {
                if (index < 0 || index >= this.examData.questions.length) return;
                
                this.currentQuestion = index;
                const question = this.examData.questions[index];
                
                // ë¬¸ì œ ë‚´ìš© í‘œì‹œ
                document.getElementById('questionNumber').textContent = `ë¬¸ì œ ${index + 1}`;
                document.getElementById('questionText').textContent = question.text;
                
                // ì„ íƒì§€ ìƒì„±
                const optionsContainer = document.getElementById('questionOptions');
                optionsContainer.innerHTML = '';
                
                question.options.forEach((option, optionIndex) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    optionDiv.onclick = () => this.selectAnswer(optionIndex);
                    
                    if (this.answers[index] === optionIndex) {
                        optionDiv.classList.add('selected');
                    }
                    
                    optionDiv.innerHTML = `
                        <div class="option-radio"></div>
                        <div class="option-text">${String.fromCharCode(65 + optionIndex)}. ${option}</div>
                    `;
                    
                    optionsContainer.appendChild(optionDiv);
                });
                
                // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì—…ë°ì´íŠ¸
                this.updateNavigation();
                
                // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                this.updateProgress();
                
                // í‘œì‹œ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                this.updateFlagButton();
            }

            selectAnswer(optionIndex) {
                this.answers[this.currentQuestion] = optionIndex;
                this.showQuestion(this.currentQuestion); // í™”ë©´ ìƒˆë¡œê³ ì¹¨
                this.updateStats();
            }

            toggleFlag() {
                if (this.flaggedQuestions.has(this.currentQuestion)) {
                    this.flaggedQuestions.delete(this.currentQuestion);
                } else {
                    this.flaggedQuestions.add(this.currentQuestion);
                }
                this.updateFlagButton();
                this.updateNavigation();
                this.updateStats();
            }

            updateNavigation() {
                const buttons = document.querySelectorAll('.question-btn');
                
                buttons.forEach((btn, index) => {
                    btn.className = 'question-btn';
                    
                    if (index === this.currentQuestion) {
                        btn.classList.add('current');
                    } else if (this.answers.hasOwnProperty(index)) {
                        btn.classList.add('answered');
                    }
                    
                    if (this.flaggedQuestions.has(index)) {
                        btn.classList.add('flagged');
                    }
                });
                
                // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ ìƒíƒœ
                document.getElementById('prevBtn').disabled = this.currentQuestion === 0;
                document.getElementById('nextBtn').disabled = 
                    this.currentQuestion === this.examData.questions.length - 1;
            }

            updateProgress() {
                const progress = ((this.currentQuestion + 1) / this.examData.questions.length) * 100;
                document.getElementById('progressFill').style.width = `${progress}%`;
                document.getElementById('progressText').textContent = 
                    `${this.currentQuestion + 1}/${this.examData.questions.length}`;
            }

            updateFlagButton() {
                const flagBtn = document.getElementById('flagBtn');
                if (this.flaggedQuestions.has(this.currentQuestion)) {
                    flagBtn.classList.add('flagged');
                    flagBtn.innerHTML = '<i class="fas fa-flag"></i> í‘œì‹œë¨';
                } else {
                    flagBtn.classList.remove('flagged');
                    flagBtn.innerHTML = '<i class="fas fa-flag"></i> í‘œì‹œ';
                }
            }

            updateStats() {
                const answeredCount = Object.keys(this.answers).length;
                const flaggedCount = this.flaggedQuestions.size;
                const remainingCount = this.examData.questions.length - answeredCount;
                
                document.getElementById('totalQuestions').textContent = this.examData.questions.length;
                document.getElementById('answeredCount').textContent = answeredCount;
                document.getElementById('flaggedCount').textContent = flaggedCount;
                document.getElementById('remainingCount').textContent = remainingCount;
            }

            startTimer() {
                this.updateTimerDisplay();
                
                this.timer = setInterval(() => {
                    this.timeRemaining--;
                    this.updateTimerDisplay();
                    
                    if (this.timeRemaining <= 0) {
                        this.timeUp();
                    }
                }, 1000);
            }

            updateTimerDisplay() {
                const minutes = Math.floor(this.timeRemaining / 60);
                const seconds = this.timeRemaining % 60;
                const timerValue = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                document.getElementById('timerValue').textContent = timerValue;
                
                const timerElement = document.getElementById('timer');
                timerElement.className = 'timer';
                
                if (this.timeRemaining <= 300) { // 5ë¶„ ì´í•˜
                    timerElement.classList.add('danger');
                } else if (this.timeRemaining <= 600) { // 10ë¶„ ì´í•˜
                    timerElement.classList.add('warning');
                }
            }

            timeUp() {
                clearInterval(this.timer);
                showAlert('ì‹œí—˜ ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìë™ìœ¼ë¡œ ì œì¶œë©ë‹ˆë‹¤.', 'warning');
                setTimeout(() => this.submitExam(), 2000);
            }

            previousQuestion() {
                if (this.currentQuestion > 0) {
                    this.showQuestion(this.currentQuestion - 1);
                }
            }

            nextQuestion() {
                if (this.currentQuestion < this.examData.questions.length - 1) {
                    this.showQuestion(this.currentQuestion + 1);
                }
            }

            submitExam() {
                const answeredCount = Object.keys(this.answers).length;
                const totalQuestions = this.examData.questions.length;
                
                if (answeredCount < totalQuestions) {
                    const confirmed = confirm(
                        `${totalQuestions - answeredCount}ê°œì˜ ë¬¸ì œê°€ ë¯¸ë‹µë³€ ìƒíƒœì…ë‹ˆë‹¤.\n` +
                        'ì •ë§ë¡œ ì‹œí—˜ì„ ì œì¶œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?'
                    );
                    if (!confirmed) return;
                }
                
                clearInterval(this.timer);
                
                // ì±„ì  ìˆ˜í–‰
                const score = this.calculateScore();
                
                showAlert('ì‹œí—˜ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                
                setTimeout(() => {
                    // ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™ (ì‹¤ì œë¡œëŠ” ê²°ê³¼ ë°ì´í„°ì™€ í•¨ê»˜)
                    window.location.href = `./results.html?score=${score}&total=${totalQuestions}`;
                }, 1500);
            }

            calculateScore() {
                let correctCount = 0;
                
                this.examData.questions.forEach((question, index) => {
                    if (this.answers[index] === question.correct) {
                        correctCount++;
                    }
                });
                
                return Math.round((correctCount / this.examData.questions.length) * 100);
            }
        }

        // ì „ì—­ í•¨ìˆ˜ë“¤
        let examPage;

        document.addEventListener('DOMContentLoaded', () => {
            examPage = new ExamPage();
        });

        function previousQuestion() {
            examPage.previousQuestion();
        }

        function nextQuestion() {
            examPage.nextQuestion();
        }

        function toggleFlag() {
            examPage.toggleFlag();
        }

        function submitExam() {
            examPage.submitExam();
        }

        function confirmExit() {
            if (confirm('ì •ë§ë¡œ ì‹œí—˜ì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì§„í–‰ ìƒí™©ì´ ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.')) {
                window.location.href = './dashboard.html';
            }
        }

        // ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°/ìƒˆë¡œê³ ì¹¨ ë°©ì§€
        window.addEventListener('beforeunload', function(e) {
            e.preventDefault();
            e.returnValue = 'ì‹œí—˜ ì¤‘ì…ë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ë– ë‚˜ì‹œê² ìŠµë‹ˆê¹Œ?';
        });
    </script>
</body>
</html>
